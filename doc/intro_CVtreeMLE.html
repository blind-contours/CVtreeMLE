<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="David McCoy" />

<meta name="date" content="2024-02-28" />

<title>Evaluating Causal Effects of Mixed Exposures using Data Adaptive Decision Trees and CV-TMLE</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Evaluating Causal Effects of Mixed
Exposures using Data Adaptive Decision Trees and CV-TMLE</h1>
<h4 class="author"><a href="https://www.davidmccoy.org/">David
McCoy</a></h4>
<h4 class="date">2024-02-28</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Data adaptive target parameters constitute a flexible framework for
estimating the effects of a data adaptively determined target parameter.
There is a literature on the dangers of deriving parameters
data-adaptively and the common approach for deriving consistent
inference for a data-adaptively defined parameter is to use
sample-splitting. In sample-splitting the researcher splits the full
data into a training set used to define the parameter, and an estimation
sample in which estimates are derived given the parameter identified in
training. Of course this approach can be costly when new samples are
collected for the estimation data or loses power when the full data is
simply split. Our proposed approach for a decision tree applied to
mixtures, aims to preserve the data-adaptive part of the sample
splitting algorithm but we define an average of the data-adaptive
parameter estimates across estimation samples based on arbitrary splits
in K-fold cross-validation. In this way, one can still use the power of
the entire dataset. The <code>CVtreeMLE</code> package implements
decision tree algorithms for computing thresholds in exposures that
maximize or minimize the outcome while flexibly adjusting for
covariates. The nodes in the decision tree are represented as a binary
exposures for which targeted minimum loss-based estimates (TMLE) are
derived for the counterfactual mean outcome difference if all individual
were exposed to the rule compared to the observed outcome under observed
exposure distribution. We call our estimate the ARE, the average
regional exposure effect.</p>
<p>Two types of results are given for the region found to minimize or
maximize the expected outcome. K-fold specific results for a given ARE
and variance estimates for a fold specific region. The pooled ARE takes
the average across folds to gain power (reduce variance). The pooled ARE
estimates the oracle target parameter which is the region that maximizes
or minimizes the expected outcome. This of course can change across the
folds and therefore this estimate, if there is inconcistency in the
region estiamted, can lead to an amalgamation of different regions.
However, if there is strong signal for a particular region, the same
exposures will be used in the region and therefore the pooled parameter
gains power, leveraging the k-fold specific estimates.</p>
<p>We give both so that researchers can look to see how consistent rules
are given sample splitting which adds information to the pooled
result.</p>
<p>For a technical presentation, the interested reader is invited to
consult <span class="citation">(<strong>mccoy2022CVtreeMLE?</strong>)</span> or the
earlier work of <span class="citation">van der Laan and Rose
(2011)</span>, <span class="citation">van der Laan and Rose
(2018)</span>, and <span class="citation">van der Laan et al.
(2022)</span>. For more background on data-adaptive target parameters
see <span class="citation">Hubbard, Kherad-Pajouh, and Van Der Laan
(2016)</span> and chapter 9 in <span class="citation">van der Laan and
Rose (2018)</span>.</p>
<p>Briefly, what this package will do is first, given the provided data
it will partition the data into folds based on the n_folds parameter
provided. In the training fold, we apply a custom decision tree that
greedily partitions the exposure space, at each partition it uses
g-computation to estimate the expected outcome for that region
controlling for covariates. It finds the region that maximizes or
minimizes the expected outcome. This is done for each fold. Then for
each region that maximizes or minimizes the expected outcome in each
fold, we estimate the effect comparing the expected outcome if everyone
was forced to be in that region compared to the observed outcome under
observed exposure. This is the ARE. This is done for each fold and we
also pool across the folds. This procedure is done with CV-TMLE. The
output are thresholds and the accompanying ARE for the region that has
the maximimum or minimum expected outcome.</p>
<p>To start, let’s load the packages we’ll need and set a seed for
simulation. We will use a real-world data example with known
ground-truth to show the functionality of <code>CVtreeMLE</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(CVtreeMLE)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(sl3)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>seed <span class="ot">&lt;-</span> <span class="dv">5454433</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span></code></pre></div>
</div>
<div id="national-institute-of-environmental-health-data" class="section level2">
<h2>National Institute of Environmental Health Data</h2>
<p>We will use simulated data from the 2015 NIEHS Mixtures Workshop
which was developed to determine if new mixture methods detect
ground-truth interactions built into the simulated data. In this way we
can simultaneously show <code>CVtreeMLE</code> output, interpretation
and validity.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>niehs_data <span class="ot">&lt;-</span> NIEHS_data_1</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">head</span>(niehs_data) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;NIEHS Data&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
NIEHS Data
</caption>
<thead>
<tr>
<th style="text-align:right;">
obs
</th>
<th style="text-align:right;">
Y
</th>
<th style="text-align:right;">
X1
</th>
<th style="text-align:right;">
X2
</th>
<th style="text-align:right;">
X3
</th>
<th style="text-align:right;">
X4
</th>
<th style="text-align:right;">
X5
</th>
<th style="text-align:right;">
X6
</th>
<th style="text-align:right;">
X7
</th>
<th style="text-align:right;">
Z
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7.534686
</td>
<td style="text-align:right;">
0.4157066
</td>
<td style="text-align:right;">
0.5308077
</td>
<td style="text-align:right;">
0.2223965
</td>
<td style="text-align:right;">
1.1592634
</td>
<td style="text-align:right;">
2.4577556
</td>
<td style="text-align:right;">
0.9438601
</td>
<td style="text-align:right;">
1.8714406
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
19.611934
</td>
<td style="text-align:right;">
0.5293572
</td>
<td style="text-align:right;">
0.9339570
</td>
<td style="text-align:right;">
1.1210595
</td>
<td style="text-align:right;">
1.3350074
</td>
<td style="text-align:right;">
0.3096883
</td>
<td style="text-align:right;">
0.5190970
</td>
<td style="text-align:right;">
0.2418065
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
12.664050
</td>
<td style="text-align:right;">
0.4849759
</td>
<td style="text-align:right;">
0.7210988
</td>
<td style="text-align:right;">
0.4629027
</td>
<td style="text-align:right;">
1.0334138
</td>
<td style="text-align:right;">
0.9492810
</td>
<td style="text-align:right;">
0.3664090
</td>
<td style="text-align:right;">
0.3502445
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
15.600288
</td>
<td style="text-align:right;">
0.8275456
</td>
<td style="text-align:right;">
1.0457137
</td>
<td style="text-align:right;">
0.9699040
</td>
<td style="text-align:right;">
0.9045099
</td>
<td style="text-align:right;">
0.9107914
</td>
<td style="text-align:right;">
0.4299847
</td>
<td style="text-align:right;">
1.0007901
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
18.606498
</td>
<td style="text-align:right;">
0.5190363
</td>
<td style="text-align:right;">
0.7802400
</td>
<td style="text-align:right;">
0.6142188
</td>
<td style="text-align:right;">
0.3729743
</td>
<td style="text-align:right;">
0.5038126
</td>
<td style="text-align:right;">
0.3575472
</td>
<td style="text-align:right;">
0.5906156
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
18.525890
</td>
<td style="text-align:right;">
0.4009491
</td>
<td style="text-align:right;">
0.8639886
</td>
<td style="text-align:right;">
0.5501847
</td>
<td style="text-align:right;">
0.9011016
</td>
<td style="text-align:right;">
1.2907615
</td>
<td style="text-align:right;">
0.7990418
</td>
<td style="text-align:right;">
1.5097039
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p>For detailed information on this simulated data please see:</p>
<p><a href="https://github.com/niehs-prime/2015-NIEHS-MIxtures-Workshop" class="uri">https://github.com/niehs-prime/2015-NIEHS-MIxtures-Workshop</a></p>
<p>Briefly, this synthetic data can be considered the results of a
prospective cohort epidemiologic study. The outcome cannot cause the
exposures (as might occur in a cross-sectional study). Correlations
between exposure variables can be thought of as caused by common sources
or modes of exposure. The nuisance variable Z can be assumed to be a
potential confounder and not a collider. There are 7 exposures which
have a complicated dependency structure. <span class="math inline">\(X_3\)</span> and <span class="math inline">\(X_6\)</span> do not have an impact on the
outcome.</p>
<p>One issue is that many machine learning algorithms will fail given
only 1 variable passed as a feature so let’s add some other
covariates.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>niehs_data<span class="sc">$</span>Z2 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(niehs_data),</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.3</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>niehs_data<span class="sc">$</span>Z3 <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(niehs_data),</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="at">size =</span> <span class="dv">1</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.1</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="run-cvtreemle" class="section level2">
<h2>Run <code>CVtreeMLE</code></h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>ptm <span class="ot">&lt;-</span> <span class="fu">proc.time</span>()</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>niehs_results <span class="ot">&lt;-</span> <span class="fu">CVtreeMLE</span>(</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">as.data.frame</span>(niehs_data),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">w =</span> <span class="fu">c</span>(<span class="st">&quot;Z&quot;</span>, <span class="st">&quot;Z2&quot;</span>, <span class="st">&quot;Z3&quot;</span>),</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">a =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">&quot;X&quot;</span>, <span class="fu">seq</span>(<span class="dv">7</span>), <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)),</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">&quot;Y&quot;</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">n_folds =</span> <span class="dv">5</span>,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="at">seed =</span> seed,</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  <span class="at">parallel_cv =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  <span class="at">parallel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="at">family =</span> <span class="st">&quot;continuous&quot;</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="at">num_cores =</span> <span class="dv">8</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="at">min_max =</span> <span class="st">&quot;min&quot;</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">min_obs =</span> <span class="dv">25</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>)</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 0 Parent mean: Inf Parent N: 400&quot;</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Best split found at depth: 0 Split on: X3 at point: 0.19&quot;</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with left rule: X3 &lt;= 0.19 &amp; &quot;</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with right rule: X3 &gt; 0.19 &amp; &quot;</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 12.4004844250252 Parent N: 29&quot;</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 12.4004844250252 Parent N: 371&quot;</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 0 Parent mean: Inf Parent N: 400&quot;</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Best split found at depth: 0 Split on: X2 at point: 0.41&quot;</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with left rule: X2 &lt;= 0.41 &amp; &quot;</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with right rule: X2 &gt; 0.41 &amp; &quot;</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 12.3730729629427 Parent N: 27&quot;</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 12.3730729629427 Parent N: 373&quot;</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 0 Parent mean: Inf Parent N: 400&quot;</span></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Best split found at depth: 0 Split on: X2 at point: 0.4&quot;</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with left rule: X2 &lt;= 0.4 &amp; &quot;</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with right rule: X2 &gt; 0.4 &amp; &quot;</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 11.668194297295 Parent N: 25&quot;</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 11.668194297295 Parent N: 375&quot;</span></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 0 Parent mean: Inf Parent N: 400&quot;</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Best split found at depth: 0 Split on: X1 at point: 0.18&quot;</span></span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with left rule: X1 &lt;= 0.18 &amp; &quot;</span></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with right rule: X1 &gt; 0.18 &amp; &quot;</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 11.8737320938925 Parent N: 29&quot;</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 11.8737320938925 Parent N: 371&quot;</span></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 0 Parent mean: Inf Parent N: 400&quot;</span></span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Best split found at depth: 0 Split on: X2 at point: 0.41&quot;</span></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with left rule: X2 &lt;= 0.41 &amp; &quot;</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Going deeper from depth: 0 with right rule: X2 &gt; 0.41 &amp; &quot;</span></span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 11.7150451328596 Parent N: 28&quot;</span></span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Depth: 1 Parent mean: 11.7150451328596 Parent N: 372&quot;</span></span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a><span class="co">#&gt; [1] &quot;No best split found at depth: 1&quot;</span></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a><span class="fu">proc.time</span>() <span class="sc">-</span> ptm</span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a><span class="co">#&gt;   8.398   0.609 179.919</span></span></code></pre></div>
</div>
<div id="mixture-results" class="section level2">
<h2>Mixture Results</h2>
<p>First let’s look at the oracle estimate. This is the pooled CV-TMLE
estimates for our parameter which is the region that maximizes or
minimizes the expected outcome - again this could be different if there
is incosistencies in estimates across the folds.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>pooled_mixture_results <span class="ot">&lt;-</span> niehs_results<span class="sc">$</span><span class="st">`</span><span class="at">Oracle Region Results</span><span class="st">`</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>pooled_mixture_results <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Oracle Mixture Results&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Oracle Mixture Results
</caption>
<thead>
<tr>
<th style="text-align:right;">
Region ARE
</th>
<th style="text-align:right;">
Standard Error
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.333
</td>
<td style="text-align:right;">
4.366
</td>
<td style="text-align:right;">
-8.224
</td>
<td style="text-align:right;">
8.891
</td>
<td style="text-align:right;">
0.939132
</td>
</tr>
</tbody>
</table>
<p>This shows that the estimate for the pooled region that minimizes the
expected outcome is -3.77, which is not significant.</p>
<p>We can look at what regions comprise this oracle region:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>region_specific_pooling <span class="ot">&lt;-</span> niehs_results<span class="sc">$</span><span class="st">`</span><span class="at">Pooled TMLE Mixture Results</span><span class="st">`</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>region_specific_pooling <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Region Specific Mixture Results&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Region Specific Mixture Results
</caption>
<thead>
<tr>
<th style="text-align:right;">
Mixture ATE
</th>
<th style="text-align:right;">
Standard Error
</th>
<th style="text-align:right;">
Lower CI
</th>
<th style="text-align:right;">
Upper CI
</th>
<th style="text-align:right;">
P-value
</th>
<th style="text-align:right;">
P-value Adj
</th>
<th style="text-align:left;">
Vars
</th>
<th style="text-align:right;">
RMSE
</th>
<th style="text-align:left;">
Average_Rule
</th>
<th style="text-align:right;">
Proportion_Folds
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.026
</td>
<td style="text-align:right;">
9.876
</td>
<td style="text-align:right;">
-18.330
</td>
<td style="text-align:right;">
20.382
</td>
<td style="text-align:right;">
0.917285
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
X1
</td>
<td style="text-align:right;">
3.283
</td>
<td style="text-align:left;">
X1 &lt;= 0.18
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.289
</td>
<td style="text-align:right;">
5.520
</td>
<td style="text-align:right;">
-10.531
</td>
<td style="text-align:right;">
11.108
</td>
<td style="text-align:right;">
0.958281
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
X2
</td>
<td style="text-align:right;">
3.009
</td>
<td style="text-align:left;">
X2 &lt;=0.407(0.4,0.41)
</td>
<td style="text-align:right;">
0.6
</td>
</tr>
<tr>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
10.432
</td>
<td style="text-align:right;">
-20.408
</td>
<td style="text-align:right;">
20.485
</td>
<td style="text-align:right;">
0.997075
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
X3
</td>
<td style="text-align:right;">
2.815
</td>
<td style="text-align:left;">
X3 &lt;= 0.19
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
</tbody>
</table>
<p>This shows 80% of the folds find a region for X2 and 20% for X1, this
becomes more consistent if higher folds are used.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>k_fold_results <span class="ot">&lt;-</span> niehs_results<span class="sc">$</span><span class="st">`</span><span class="at">V-Specific Mix Results</span><span class="st">`</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>k_fold_results <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;K-fold Results&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">html_font =</span> <span class="st">&quot;Cambria&quot;</span>)</span></code></pre></div>
<table class=" lightable-classic" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
K-fold Results
</caption>
<thead>
<tr>
<th style="text-align:right;">
are
</th>
<th style="text-align:right;">
se
</th>
<th style="text-align:right;">
lower_ci
</th>
<th style="text-align:right;">
upper_ci
</th>
<th style="text-align:right;">
p_val
</th>
<th style="text-align:right;">
p_val_adj
</th>
<th style="text-align:right;">
rmse
</th>
<th style="text-align:left;">
mix_rule
</th>
<th style="text-align:right;">
fold
</th>
<th style="text-align:left;">
variables
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
10.432
</td>
<td style="text-align:right;">
-20.408
</td>
<td style="text-align:right;">
20.485
</td>
<td style="text-align:right;">
0.997075
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.815
</td>
<td style="text-align:left;">
X3 &lt;= 0.19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
X3
</td>
</tr>
<tr>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
9.759
</td>
<td style="text-align:right;">
-19.097
</td>
<td style="text-align:right;">
19.158
</td>
<td style="text-align:right;">
0.997526
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.099
</td>
<td style="text-align:left;">
X2 &lt;= 0.41
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
X2
</td>
</tr>
<tr>
<td style="text-align:right;">
0.354
</td>
<td style="text-align:right;">
9.774
</td>
<td style="text-align:right;">
-18.803
</td>
<td style="text-align:right;">
19.511
</td>
<td style="text-align:right;">
0.971125
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2.712
</td>
<td style="text-align:left;">
X2 &lt;= 0.4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
X2
</td>
</tr>
<tr>
<td style="text-align:right;">
1.026
</td>
<td style="text-align:right;">
9.876
</td>
<td style="text-align:right;">
-18.330
</td>
<td style="text-align:right;">
20.382
</td>
<td style="text-align:right;">
0.917285
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.283
</td>
<td style="text-align:left;">
X1 &lt;= 0.18
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
X1
</td>
</tr>
<tr>
<td style="text-align:right;">
0.717
</td>
<td style="text-align:right;">
9.243
</td>
<td style="text-align:right;">
-17.398
</td>
<td style="text-align:right;">
18.832
</td>
<td style="text-align:right;">
0.938135
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.237
</td>
<td style="text-align:left;">
X2 &lt;= 0.41
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
X2
</td>
</tr>
</tbody>
</table>
</div>
<div id="estimate-stability" class="section level2">
<h2>Estimate Stability</h2>
<p>Because we are identifying thresholds mixture space data-adaptively
using the training data as we rotate through the folds,
<code>CVtreeMLE</code> will give, in the event that a signal actually
exists, more consistent results when higher n_fold values are used.
Thus, we recommend using 10-fold CV when possible for more consistent
and interpretable results. Here, 5-fold was used simply for convenience
in compiling and testing.</p>
<p>It should be noted that, especially in the marginal results, if the
analyst chooses to report on results for one fold, which does have valid
inference, the variability of the thresholds and estimates across the
folds should also be provided for full transparency.</p>
</div>
<div id="runtime-performance-guidelines" class="section level2">
<h2>Runtime Performance Guidelines</h2>
<p><code>CVtreeMLE</code> uses ensemble machine learning which is
obviously computationally demanding. The <code>utils_create_sls.R</code>
function creates some lean yet non-parametric ensemble learners for each
parameter. For example, glm, elastic net, random forest, and xgboost
models are created for the nuisance parameters and decision trees of
various depths are created for the decision tree fitting Super Learner.
Users are also welcome to pass their own stacks of learners in to
<code>CVtreeMLE</code> if they feel the default estimators are
insufficient given the complexity of the data. Additionally, to help
with computational time, <code>CVtreeMLE</code> uses the future package
for sequential and parallel processing. The default functionality is to
parallelize across the folds (parallel_cv = TRUE). The default
parallelization type is multi-session, this is because we expect most
users to be programming in Rstudio where multicore is not supported.
Thus, a user should expected multiple cores to be in use, the number
which is equal to num_cores with high CPU usage on each core because the
data and models are copied to each core. This is different from
multicore where the data is not copied. As we saw above, in this
example, a dataset with 500 observations and 7 exposures took about 5
minutes with 5 folds. Thus, when using 10-fold CV, which we recommend,
on a standard environmental epidemiology data set of 500- 1000
observations, <code>CVtreeMLE</code> should run easily on a modern local
machine.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Hubbard2016" class="csl-entry">
Hubbard, Alan E., Sara Kherad-Pajouh, and Mark J. Van Der Laan. 2016.
<span>“<span class="nocase">Statistical Inference for Data Adaptive
Target Parameters</span>.”</span> <em>International Journal of
Biostatistics</em> 12 (1): 3–19. <a href="https://doi.org/10.1515/ijb-2015-0013">https://doi.org/10.1515/ijb-2015-0013</a>.
</div>
<div id="ref-vdl2022targeted" class="csl-entry">
van der Laan, Mark J, Jeremy R Coyle, Nima S Hejazi, Ivana Malenica,
Rachael V Phillips, and Alan E Hubbard. 2022. <em><span class="nocase">Targeted Learning in <code>R</code>: A Causal Data
Science Handbook</span></em>. CRC Press. <a href="https://tlverse.org/tlverse-handbook/">https://tlverse.org/tlverse-handbook/</a>.
</div>
<div id="ref-vdl2011targeted" class="csl-entry">
van der Laan, Mark J, and Sherri Rose. 2011. <em>Targeted Learning:
Causal Inference for Observational and Experimental Data</em>. Springer
Science &amp; Business Media.
</div>
<div id="ref-vdl2018targeted" class="csl-entry">
———. 2018. <em>Targeted Learning in Data Science: Causal Inference for
Complex Longitudinal Studies</em>. Springer Science &amp; Business
Media.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
